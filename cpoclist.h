#ifndef CPOCLIST_H
#define CPOCLIST_H

#include <QDir>
#include <QString>
#include <QDebug>
#include <string>
using std::string;


class CPocList
{
    /* 
        这里是一个POC所有的属性
        <poc>
            <name> poc脚本文件名 </name>
            <tag>  对应的cve名 </tag>
            <folder> poc脚本所在的文件夹 </folder>
            <sys> windows/linux 在上面选择 </sys>
            <app> 中间件的名称 </app>
            <cms> true/false 是否是cms相关漏洞 </cms>
            <description> 描述信息 </<description>
            <pyver> python版本 </pyver>
            <expfile> exp文件 </expfile>
            <vulnInfo> 漏洞信息文件 </vulnInfo>
        </poc>
     */
    char xml_name[11][24] = {
        "name",
        "tag",
        "folder",
        "sys",
        "app",
        "cms",
        "ports",
        "description",
        "pyver",
        "expfile",
        "vulnInfo"
    };

    /**
     * @brief 得到xml项在 xml_name数组 对应的编号。如 传入[folder],返回2
     * @param xml_name的某一项
     * @return  在 xml_name 中的下标
     */
    int get_xml_name_idx(const char* in);
public:
    CPocList();

    /**
     * @brief 解析xml文件，转换成poc链表
     */
    void parse_poc_xml();
};

#endif // CPOCLIST_H
