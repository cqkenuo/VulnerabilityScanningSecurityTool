#include "dialog_scanports.h"
#include "gshared.h"
#include "ui_dialog_scanports.h"


Dialog_ScanPorts::Dialog_ScanPorts(QWidget *parent) :
    QDialog(parent),
    ui(new Ui::Dialog_ScanPorts)
{
    ui->setupUi(this);

    ui->listView_ports->setModel(&_list_model);
}

Dialog_ScanPorts::~Dialog_ScanPorts()
{
    delete ui;
}

void Dialog_ScanPorts::slot_readyReadData(QString content)
{
    qDebug() << "slot_readyReadData";
    QStandardItem* item_procName = new QStandardItem(content);
    _list_model.appendRow(item_procName);
    ui->listView_ports->addAction(new QAction(content));
}

void Dialog_ScanPorts::on_button_startScanPorts_clicked()
{
    QString host = "172.16.5.204";
    GShared::scan_port_thread.set_host(host);
    GShared::start_scan_port_thread(this);
    //// 准备开始真正的执行python脚本
    //// 新建一个线程
    //QThread* m_workerThread = new QThread();
    //// 新建一个真正工作的线程
    ////THREAD_SCANPORT* worker_thread = new THREAD_SCANPORT();

    //connect(&_scan_port_thread, SIGNAL(signal_readyReadData(QString)), this, SLOT(slot_readyReadData));

    //QObject::connect(m_workerThread, &QThread::started, &_scan_port_thread, &THREAD_SCANPORT::start1);//on_exe_pyscript_thread_finished
    //QObject::connect(m_workerThread, &QThread::finished, m_workerThread, &QThread::deleteLater);
    //QObject::connect(&_scan_port_thread, &THREAD_SCANPORT::workFinished, &_scan_port_thread, &THREAD_SCANPORT::deleteLater);
    //QObject::connect(&_scan_port_thread, &THREAD_SCANPORT::workFinished, m_workerThread, &QThread::quit);

    //_scan_port_thread.moveToThread(m_workerThread);
    //m_workerThread->start();
}
