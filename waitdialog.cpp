#include "waitdialog.h"
#include "gshared.h"
#include <QLabel>
#include <QMovie>

WaitDialog::WaitDialog(QWidget *parent)
{
    this->setFixedSize(150,150);
    setWindowOpacity(0.7);          //设置透明用；
    this->setWindowFlags(Qt::Dialog|Qt::CustomizeWindowHint);

    //取消对话框标题
    //this->setWindowFlags(Qt::Dialog|Qt::FramelessWindowHint);

    //取消对话框标题和边框
    //this->setAutoFillBackground(true);
    this->setContentsMargins(0,0,0,0);
    QLabel *label = new  QLabel(this);
    label->setContentsMargins(0,0,0,0);
    /*QPalettepalette;palette.setBrush(QPalette::Background,QBrush(QPixmap("E:/qml/imgdialog/loading.gif")));
    this->setPalette(palette)*/;

    QMovie *movie = new QMovie(GShared::program_path + "/src/miku.gif");
    label->setMovie(movie);
    movie->start();
}

WaitDialog::~WaitDialog()
{
    if(_label != nullptr)
    {
        qDebug() << "~WaitDialog";
        delete _label;
    }

    if(_movie != nullptr)
    {
        delete _movie;
    }
}

void WaitDialog::signal_havaFinished()
{
    this->close();
}

