[toc]

## 主要业务逻辑

1 解析gconfig.xml获取poc的筛选信息,以及poc的信息

2 确定目标(主机)

3 确定执行的POC集(根据用户选择筛选)

4 执行Python脚本扫描目标(主机)的开放端口

5 根据POC的信息找到对应的Python脚本,执行它

6 接收Python脚本的返回值

7 判断是否具有漏洞:有显示,没有就不显示任何信息

## gconfig.xml文件

- 最外标签`<niso></niso>`

- `<sys></sys>`

  system.针对操作系统进行筛选.

- `<app></app>`

  application.针对中间件进行筛选.

- `<cms></cms>`

  是否是cms漏洞

- `<poc></poc>`

  name: poc文件名

  tag: 漏洞名

  folder: poc文件所在的文件夹

  sys:筛选

  app:筛选

  cms:筛选

  ports:预定义的扫描端口.

  > 单端口:`<ports>8009</ports>`
  >
  > 多端口,用空格隔开:`<ports>8009 8080</ports>`

  description:描述性信息,用于显示在扫描结果表中的**描述**这一列.

  > 作用: 解释漏洞的基本信息,如果有补丁地址也在这里给出.
  >
  > 超链接的使用方法:
  >
  > 因为`<a></a>`在解析xml时会当成一个独立标签,所以需要针对这个进行处理.
  >
  > 用`nisolinkAS`代替`<a  href=`;用`nisolinkAE`代替`</a>`
  >
  > 如:`<a href=http://www.baidu.com>http://www.baidu.com</a>` 应更新为:`nisolinkAShttp://www.baidu.com>http://www.baidu.comnisolinkAE`

## 端口扫描模块

### 参数格式

`<host> <dir> <欲扫描的端口> <线程数量>`

> 参数1:目标的IP地址.
>
> 参数2:程序所在的绝对路径(包含最后斜杠)
>
> 参数3:
>
> - 0:用常规端口扫描. 常规端口在扫描Python文件中由作者定义.
> - 其他:端口范围.如"233-666"
>
> 参数4:开启多少个线程用于扫描端口(不建议超过20)

### 输出格式

输出端口的字符串用`NISOPORTST`和`NISOPORTED`包裹起来.**输出内容为`host port`,中间用空格隔开**.

如,想要输出`172.16.5.204`主机上开放了端口`433`, 正常写法:`print('172.16.5.204 433')`,应修改为:`print'NISOPORTST172.16.5.204 433NISOPORTED'`.

## 调用POC脚本模块

### 调用参数格式

`<program dir> <host> <port>`

> 参数1:程序所在的绝对路径(包含最后的反斜杠)
>
> 参数2:主机IP
>
> 参数3:端口

### 返回值

`exit(int)`

> exit(0):存在漏洞.
>
> exit(1):不存在漏洞.
>
> exit(-1):异常.

